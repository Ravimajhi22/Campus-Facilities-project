package com.campusFacilities.www.service.Imp;

import java.time.LocalDate;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;

import com.campusFacilities.www.model.Hostel.Hostel;
import com.campusFacilities.www.model.Hostel.HostelBlock;
import com.campusFacilities.www.model.Hostel.HostelRoom;
import com.campusFacilities.www.model.Hostel.StudentHostelAllocation;
import com.campusFacilities.www.repository.Hostel.HostelBlockRepository;
import com.campusFacilities.www.repository.Hostel.HostelComplaintRepository;
import com.campusFacilities.www.repository.Hostel.HostelFeeRepository;
import com.campusFacilities.www.repository.Hostel.HostelRepository;
import com.campusFacilities.www.repository.Hostel.HostelRoomRepository;
import com.campusFacilities.www.repository.Hostel.StudentHostelAllocationRepository;

public class HostelServiceImpl {
	   @Autowired private HostelRepository hostelRepo;
	    @Autowired private HostelBlockRepository blockRepo;
	    @Autowired private HostelRoomRepository roomRepo;
	    @Autowired private StudentHostelAllocationRepository allocationRepo;
	    @Autowired private HostelFeeRepository feeRepo;
	    @Autowired private HostelComplaintRepository complaintRepo;
	    @Autowired private UserRepository userRepo;

	    /* ========= HOSTEL ========= */
	    public Hostel createHostel(Hostel hostel) {
	        return hostelRepo.save(hostel);
	    }

	    public List<Hostel> getAllHostels() {
	        return hostelRepo.findAll();
	    }

	    public Hostel getHostel(Long id) {
	        return hostelRepo.findById(id)
	                .orElseThrow(() -> new RuntimeException("Hostel not found"));
	    }

	    public Hostel updateHostel(Long id, Hostel hostel) {
	        Hostel h = getHostel(id);
	        h.setHostelName(hostel.getHostelName());
	        h.setHostelType(hostel.getHostelType());
	        h.setWardenName(hostel.getWardenName());
	        return hostelRepo.save(h);
	    }

	    public void deleteHostel(Long id) {
	        hostelRepo.deleteById(id);
	    }

	    /* ========= BLOCK ========= */
	    public HostelBlock createBlock(Long hostelId, HostelBlock block) {
	        block.setHostel(getHostel(hostelId));
	        return blockRepo.save(block);
	    }

	    public List<HostelBlock> getBlocks(Long hostelId) {
	        return blockRepo.findByHostelHostelId(hostelId);
	    }

	    public HostelBlock updateBlock(Long blockId, HostelBlock block) {
	        HostelBlock b = blockRepo.findById(blockId)
	                .orElseThrow(() -> new RuntimeException("Block not found"));
	        b.setBlockName(block.getBlockName());
	        b.setTotalFloors(block.getTotalFloors());
	        return blockRepo.save(b);
	    }

	    public void deleteBlock(Long blockId) {
	        blockRepo.deleteById(blockId);
	    }

	    /* ========= ROOM ========= */
	    public HostelRoom createRoom(Long blockId, HostelRoom room) {
	        HostelBlock block = blockRepo.findById(blockId)
	                .orElseThrow(() -> new RuntimeException("Block not found"));
	        room.setBlock(block);
	        return roomRepo.save(room);
	    }

	    public List<HostelRoom> getRooms(Long blockId) {
	        return roomRepo.findByBlockBlockId(blockId);
	    }

	    public HostelRoom getRoom(Long roomId) {
	        return roomRepo.findById(roomId)
	                .orElseThrow(() -> new RuntimeException("Room not found"));
	    }

	    public HostelRoom updateRoom(Long roomId, HostelRoom room) {
	        HostelRoom r = getRoom(roomId);
	        r.setRoomType(room.getRoomType());
	        r.setCapacity(room.getCapacity());
	        r.setStatus(room.getStatus());
	        return roomRepo.save(r);
	    }

	    public void deleteRoom(Long roomId) {
	        roomRepo.deleteById(roomId);
	    }

	    /* ========= ALLOCATION ========= */
	    public StudentHostelAllocation allocateRoom(Long userId, Long roomId, LocalDate joinDate) {
	        HostelRoom room =

}
